{
  "version": "2.4.1",
  "summary": {
    "title": "Online banking for legal entities",
    "owner": "Maria",
    "description": "Online banking for making payments between legal entities.\nOpportunities:\n- online payments (with a scan of the payment order, signed in the EDI),\n- batch payments (xlsx + orders),\n- verification of the validity of the signature and the correspondence of the details,\n- conducting internal transfers.",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "Internet bank STRIDE diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.4.1",
        "cells": [
          {
            "position": {
              "x": -784.0000000000002,
              "y": 80.00000000000182
            },
            "size": {
              "width": 300,
              "height": 280
            },
            "attrs": {
              "label": {
                "text": "DMZ"
              }
            },
            "visible": true,
            "shape": "trust-boundary-box",
            "zIndex": -1,
            "id": "109af916-55ac-4cdd-acf9-3bee6a259ebd",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "DMZ",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": -790.0000000000007,
              "y": -210
            },
            "size": {
              "width": 620,
              "height": 220
            },
            "attrs": {
              "label": {
                "text": "Внешняя сеть (интернет)"
              }
            },
            "visible": true,
            "shape": "trust-boundary-box",
            "zIndex": -1,
            "id": "b6499935-0737-47e0-a4cc-2cf58f0d11c0",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Внешняя сеть (интернет)",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": -1140,
              "y": 440
            },
            "size": {
              "width": 1440,
              "height": 1310
            },
            "attrs": {
              "label": {
                "text": "Внутренний сегмент "
              }
            },
            "visible": true,
            "shape": "trust-boundary-box",
            "zIndex": -1,
            "id": "9c679bc2-9b8b-4d2d-8122-abd6adf23ffc",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Внутренний сегмент ",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": -524.0000000000002,
              "y": 730
            },
            "size": {
              "width": 180,
              "height": 130
            },
            "visible": true,
            "shape": "trust-boundary-box",
            "zIndex": -1,
            "id": "202f1e27-0973-417e-9899-8ed89ac10453",
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Trust Boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": -750.0000000000007,
              "y": -134.9999999999999
            },
            "size": {
              "width": 150,
              "height": 70
            },
            "attrs": {
              "text": {
                "text": "Клиент"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "d00f5b0d-7f69-4865-825a-538f202de9f1"
                },
                {
                  "group": "right",
                  "id": "814da67d-d79f-42a9-acd7-4948bb5e3568"
                },
                {
                  "group": "bottom",
                  "id": "4873277a-e423-4056-88cf-0593684815d4"
                },
                {
                  "group": "left",
                  "id": "25c4cb37-6f11-41bd-839d-47e104bc94b7"
                }
              ]
            },
            "id": "2ba39e6f-76a6-410d-a25c-e3918b064bcb",
            "data": {
              "type": "tm.Actor",
              "name": "Клиент",
              "description": "Представитель юрлица",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": -364.0000000000002,
              "y": -135
            },
            "size": {
              "width": 160,
              "height": 70
            },
            "attrs": {
              "text": {
                "text": "Система ЭДО"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 2,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "d00f5b0d-7f69-4865-825a-538f202de9f1"
                },
                {
                  "group": "right",
                  "id": "814da67d-d79f-42a9-acd7-4948bb5e3568"
                },
                {
                  "group": "bottom",
                  "id": "4873277a-e423-4056-88cf-0593684815d4"
                },
                {
                  "group": "left",
                  "id": "25c4cb37-6f11-41bd-839d-47e104bc94b7"
                }
              ]
            },
            "id": "1471c41a-9f45-4928-b107-a69bd94e9813",
            "data": {
              "type": "tm.Actor",
              "name": "Система ЭДО",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": -719,
              "y": 150
            },
            "size": {
              "width": 180,
              "height": 150
            },
            "attrs": {
              "text": {
                "text": "Banking Web App"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "ad78a8d6-ece0-40e1-b4ce-3fca192d05d5"
                },
                {
                  "group": "right",
                  "id": "5c5e1e67-3b25-429a-879e-2f153a38b797"
                },
                {
                  "group": "bottom",
                  "id": "efb5d4ac-c626-4c03-bdbe-56e831a970bf"
                },
                {
                  "group": "left",
                  "id": "8dc20c30-944c-47cd-8659-b9650bca409e"
                }
              ]
            },
            "id": "59365fed-f022-42d1-b98a-e90c14275673",
            "data": {
              "type": "tm.Process",
              "name": "Banking Web App",
              "description": "Принимает запросы от клиента и обращается к внутренним сервисам",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": -960.0000000000007,
              "y": 760
            },
            "size": {
              "width": 170,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Payment \nHandler"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 4,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "ad78a8d6-ece0-40e1-b4ce-3fca192d05d5"
                },
                {
                  "group": "right",
                  "id": "5c5e1e67-3b25-429a-879e-2f153a38b797"
                },
                {
                  "group": "bottom",
                  "id": "efb5d4ac-c626-4c03-bdbe-56e831a970bf"
                },
                {
                  "group": "left",
                  "id": "8dc20c30-944c-47cd-8659-b9650bca409e"
                }
              ]
            },
            "id": "48fc3a97-9de7-4c7e-b8ad-273e83a2fce8",
            "data": {
              "type": "tm.Process",
              "name": "Payment \nHandler",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": -70,
              "y": 760
            },
            "size": {
              "width": 190,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Batch \nPayment \nHandler"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 5,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "ad78a8d6-ece0-40e1-b4ce-3fca192d05d5"
                },
                {
                  "group": "right",
                  "id": "5c5e1e67-3b25-429a-879e-2f153a38b797"
                },
                {
                  "group": "bottom",
                  "id": "efb5d4ac-c626-4c03-bdbe-56e831a970bf"
                },
                {
                  "group": "left",
                  "id": "8dc20c30-944c-47cd-8659-b9650bca409e"
                }
              ]
            },
            "id": "fbcb8cd5-9bf4-4070-8770-1d779e920134",
            "data": {
              "type": "tm.Process",
              "name": "Batch \nPayment \nHandler",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": -570.0000000000007,
              "y": 1640
            },
            "size": {
              "width": 120,
              "height": 70
            },
            "attrs": {
              "text": {
                "text": "Logs"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 9,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "28b60d21-a9bc-4a13-9b6e-87fc49812f98"
                },
                {
                  "group": "right",
                  "id": "d799d141-4b6c-4dfe-b717-1b3da5195897"
                },
                {
                  "group": "bottom",
                  "id": "31815991-733a-4361-bb4a-40e8ebbfb748"
                },
                {
                  "group": "left",
                  "id": "d4db1e5b-6184-4d22-a276-9b43cadd2cc6"
                }
              ]
            },
            "id": "43bcaf69-b2e0-4b04-8a2c-ef59320f6673",
            "data": {
              "type": "tm.Store",
              "name": "Logs",
              "description": "Действия пользователей + системные",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Создание платежа/запрос данных о платеже\nДанные: реквизиты, скан подписанного поручения",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "ce94c6a9-56e1-41e8-b8db-f1c2a3101386",
                  "title": "[1] Возможность перехвата платежных данных",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "CWE-345: Insufficient Verification of Data Authenticity\nВозможность перехвата злоумшленником реквизитов платежа или скана с возможностью изменить эти данные.\n",
                  "mitigation": "13.3.2 ASVS\n[1] Тело сообщения подписывается с помощью WS-Security, чтобы обеспечить безопасную передачу между клиентом и сервисом\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": ""
                },
                {
                  "id": "73499dab-6099-424f-8c3d-8426019c02e3",
                  "title": "[1] Угроза MiTM атаки",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "CWE-319: Cleartext Transmission of Sensitive Information\nУгроза MiTM атаки (перехват реквизитов платежей и сканов поручений)\n",
                  "mitigation": "8.3.1 ASVS\n[1] В параметрах HTTP-запроса не содержится конфиденциальных данных. Вместо этого они отправляются на сервер в теле или заголовках HTTP-сообщения.\nНеобходимо шифровать данные при передаче (HTTPS)\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": ""
                },
                {
                  "id": "ae9ca424-dba7-4d4f-a853-61f594a7f793",
                  "title": "[1] Устаревший протокол TLS",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "CWE-326: Inadequate Encryption Strength\nПерехват сессионных данных или данных платежа при использовании устаревшей версии протокола TLS.\nMiTM\n",
                  "mitigation": "9.1.3 ASVS\n[1] Использование только актуальных версий TLS протокола (TLS 1.2 и TLS 1.3)\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 13,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 4,
                "denialOfService": 0
              }
            },
            "labels": [
              "Создание платежа/запрос данных о платеже\nДанные: реквизиты, скан подписанного поручения"
            ],
            "id": "db473162-fe5e-49b5-9ada-b61decdb9508",
            "source": {
              "cell": "2ba39e6f-76a6-410d-a25c-e3918b064bcb",
              "port": "4873277a-e423-4056-88cf-0593684815d4"
            },
            "target": {
              "cell": "59365fed-f022-42d1-b98a-e90c14275673",
              "port": "ad78a8d6-ece0-40e1-b4ce-3fca192d05d5"
            },
            "vertices": [
              {
                "x": -650,
                "y": 50
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Платежное поручение\nОбратно: подписанное поручение",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "3f4db22f-96fa-4fdc-886c-af1392926280",
                  "title": "[1][1] Ошибки в проверке сертификата  ",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "CWE-295: Improper Certificate Validation\nФальшивый сертификат ЭДО, клиент примет подделку, если не проверяет цепочку доверия\nБез mTLS внутри сети злоумышленник может перехватить запросы на выполнение платежа, идущие к CBS\n",
                  "mitigation": "1.9.2 ASVS\n[1] Компоненты приложения должны аутентифицировать каждую сторону\nвзаимодействия, чтобы предотвратить mitm атаки.\nНапример, компоненты должны проверять сертификаты и цепочки доверия TLS.\n\n9.2.1 ASVS\n[1] Для подключения к и от сервера используются доверенные сертификаты TLS. Сервер должен быть настроен так, чтобы доверять только утвержденным внутренним центрам сертификации. Все остальные должны отвергаться.\nТакже конфиденциальные данные, закрытые ключи и\nсертификаты должны безопасно храниться в Secure Element, TPM, TEE (Trusted\nExecution Environment) или быть защищены с помощью стойкой криптографии.\n\n\n\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 15,
                  "score": ""
                },
                {
                  "id": "bf93927b-7dbe-4518-bd67-053b9229c7ea",
                  "title": "[2] Отстутствие аутентификации обеих сторон",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "CWE-295: Improper Certificate Validation\nФальшивый сертификат ЭДО, клиент примет подделку, если не проверяет цепочку доверия\nБез mTLS внутри сети злоумышленник может перехватить запросы на выполнение платежа, идущие к CBS\n",
                  "mitigation": "1.9.2\n[2] Аутентификация обеих сторон",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 4,
                "denialOfService": 0
              }
            },
            "labels": [
              "Платежное поручение\nОбратно: подписанное поручение"
            ],
            "id": "4fab8787-c70b-44f3-a3dd-818ad62cbe45",
            "source": {
              "cell": "2ba39e6f-76a6-410d-a25c-e3918b064bcb",
              "port": "814da67d-d79f-42a9-acd7-4948bb5e3568"
            },
            "target": {
              "cell": "1471c41a-9f45-4928-b107-a69bd94e9813",
              "port": "25c4cb37-6f11-41bd-839d-47e104bc94b7"
            },
            "vertices": [
              {
                "x": -480,
                "y": -150
              },
              {
                "x": -420,
                "y": -120
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Запрос + данные",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "77e37f58-f7ec-4277-a50f-1362eb981fd2",
                  "title": "[1] Отсутствие шифрования передаваемых данных",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "CWE-319: Cleartext Transmission of Sensitive Information\nЗлоумышленник перехватывает платежные данные идущие от клиента к API Gateway\n",
                  "mitigation": "2.2.5 ASVS\n[1] Использование протокола mTLS с взаимной аутентификацией\n\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 14,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 2,
                "denialOfService": 0
              }
            },
            "labels": [
              "Запрос + данные"
            ],
            "id": "0fe42497-f732-4e2d-b43d-60d909ca82d7",
            "source": {
              "x": -626,
              "y": 300
            },
            "target": {
              "cell": "48746edf-5f59-4c41-8064-2a9175636b03",
              "port": "20ad7dec-6763-4849-af93-9ce8b7a3f86e"
            },
            "vertices": [
              {
                "x": -626,
                "y": 410
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "1.b Архив с формами платежа и сканами поручений",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "1.b Архив с формами платежа и сканами поручений"
            ],
            "id": "dd011d79-8a20-46db-9e8d-e47725f13cea",
            "source": {
              "x": -604,
              "y": 670
            },
            "target": {
              "cell": "fbcb8cd5-9bf4-4070-8770-1d779e920134",
              "port": "ad78a8d6-ece0-40e1-b4ce-3fca192d05d5"
            },
            "vertices": [
              {
                "x": -260,
                "y": 700
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "События входа в процесс",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "События входа в процесс"
            ],
            "id": "f5ef6c9a-4e60-4cef-a526-1fc6837e973c",
            "source": {
              "cell": "d014f1e7-0413-40f0-8043-3b1852c9d759",
              "port": "32aa521f-f51f-470d-9b99-7bfe6a79faee"
            },
            "target": {
              "cell": "4790455c-35ab-402c-82a2-acc71bfe3bbe",
              "port": "20ad7dec-6763-4849-af93-9ce8b7a3f86e"
            },
            "vertices": [
              {
                "x": -970,
                "y": 1270
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Пакетные события",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Пакетные события"
            ],
            "id": "0e7e7034-3ec2-474e-8ce2-050ca9ee7765",
            "source": {
              "cell": "fbcb8cd5-9bf4-4070-8770-1d779e920134",
              "port": "efb5d4ac-c626-4c03-bdbe-56e831a970bf"
            },
            "target": {
              "cell": "4790455c-35ab-402c-82a2-acc71bfe3bbe",
              "port": "20ad7dec-6763-4849-af93-9ce8b7a3f86e"
            },
            "vertices": [
              {
                "x": -100,
                "y": 1310
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "3.a Отправка платежана обработку\nОбратно: статус выполнения",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "ee3a4d1d-83f2-4985-8759-f65e76bd84fc",
                  "title": "[1][1] Отсутствие проверки цепочки доверия сертификаторов и подлинности сертификатов",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "CWE-295: Improper Certificate Validation\nФальшивый сертификат ЭДО, клиент примет подделку, если не проверяет цепочку доверия\nБез mTLS внутри сети злоумышленник может перехватить запросы на выполнение платежа, идущие к CBS\n",
                  "mitigation": "1.9.2 ASVS\n[1] Компоненты приложения должны аутентифицировать каждую сторону\nвзаимодействия, чтобы предотвратить mitm атаки.\nНапример, компоненты должны проверять сертификаты и цепочки доверия TLS.\n\n9.2.1 ASVS\n[1] Для подключения к и от сервера используются доверенные сертификаты TLS. Сервер должен быть настроен так, чтобы доверять только утвержденным внутренним центрам сертификации. Все остальные должны отвергаться.\nТакже конфиденциальные данные, закрытые ключи и\nсертификаты должны безопасно храниться в Secure Element, TPM, TEE (Trusted\nExecution Environment) или быть защищены с помощью стойкой криптографии.\n\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 17,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "3.a Отправка платежана обработку\nОбратно: статус выполнения"
            ],
            "id": "1e0d973a-b993-4927-802b-02fb1c41e961",
            "source": {
              "x": -816,
              "y": 820
            },
            "target": {
              "cell": "53f1cb85-09a7-4c06-8810-f5fad1cb01f4",
              "port": "4bc7dcfc-dcbc-4f05-b6c9-9ea7ad88446a"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "1.a Данные платежа",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "1.a Данные платежа"
            ],
            "id": "09aed096-458b-411d-bcfd-864c5b3f5bcd",
            "source": {
              "x": -614,
              "y": 670
            },
            "target": {
              "cell": "48fc3a97-9de7-4c7e-b8ad-273e83a2fce8",
              "port": "ad78a8d6-ece0-40e1-b4ce-3fca192d05d5"
            },
            "vertices": [
              {
                "x": -720,
                "y": 730
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "События \nпроверки подписи",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "События \nпроверки подписи"
            ],
            "id": "f1c82d3a-5cb9-402f-9ad4-63eb63ad63e1",
            "source": {
              "cell": "2c898429-5749-419d-9a01-b076c4eeeb75",
              "port": "32aa521f-f51f-470d-9b99-7bfe6a79faee"
            },
            "target": {
              "cell": "4790455c-35ab-402c-82a2-acc71bfe3bbe",
              "port": "20ad7dec-6763-4849-af93-9ce8b7a3f86e"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "2.b Данные: сканы поручений\nОбратно: статус проверки",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "2.b Данные: сканы поручений\nОбратно: статус проверки"
            ],
            "id": "bada4bd7-7cbc-4952-ba60-bf61c186bfe5",
            "source": {
              "cell": "fbcb8cd5-9bf4-4070-8770-1d779e920134",
              "port": "efb5d4ac-c626-4c03-bdbe-56e831a970bf"
            },
            "target": {
              "cell": "2c898429-5749-419d-9a01-b076c4eeeb75",
              "port": "2581dd27-b8ff-4e67-9847-132e8f082a7d"
            },
            "vertices": [
              {
                "x": -180,
                "y": 1140
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "2.a Данные: скан поручения\nОбратно: статус проверки подписи",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "2.a Данные: скан поручения\nОбратно: статус проверки подписи"
            ],
            "id": "67d82ae9-33b4-4516-8e62-cc15d31344fc",
            "source": {
              "cell": "48fc3a97-9de7-4c7e-b8ad-273e83a2fce8",
              "port": "efb5d4ac-c626-4c03-bdbe-56e831a970bf"
            },
            "target": {
              "cell": "2c898429-5749-419d-9a01-b076c4eeeb75",
              "port": "4bc7dcfc-dcbc-4f05-b6c9-9ea7ad88446a"
            },
            "vertices": [
              {
                "x": -740,
                "y": 1130
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Транзакционные\nсобытия",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Транзакционные\nсобытия"
            ],
            "id": "6492f7d0-ec91-435b-9c3a-d3a71024e2e7",
            "source": {
              "cell": "48fc3a97-9de7-4c7e-b8ad-273e83a2fce8",
              "port": "efb5d4ac-c626-4c03-bdbe-56e831a970bf"
            },
            "target": {
              "cell": "4790455c-35ab-402c-82a2-acc71bfe3bbe",
              "port": "20ad7dec-6763-4849-af93-9ce8b7a3f86e"
            },
            "vertices": [
              {
                "x": -820,
                "y": 1230
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              ""
            ],
            "id": "466fcbe4-6ffd-4a52-9323-46349d882408",
            "source": {
              "x": -505,
              "y": 1580
            },
            "target": {
              "cell": "43bcaf69-b2e0-4b04-8a2c-ef59320f6673",
              "port": "28b60d21-a9bc-4a13-9b6e-87fc49812f98"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "",
              "description": "Данные платежа (запись и чтение)",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "4b8fa735-7f30-4113-961a-400318005c72",
                  "title": "[1] Угроза SQL-инъекции",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "+Tampering\nCWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\nВнедрение SQL-инъекции через поля платежного поручения, что может привести к утечке/повреждению хранимых данных.\n",
                  "mitigation": "5.3.5\n[1] Экранирование SQL \n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 19,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              ""
            ],
            "id": "725816d4-f34e-4656-8c8e-32d6e6e9fcd1",
            "source": {
              "x": -870,
              "y": 880
            },
            "target": {
              "cell": "7d330732-e00a-4f00-a09a-264b07404b20",
              "port": "7e99e1b6-23d5-4e08-b2f5-1e3809dccb5e"
            },
            "vertices": [
              {
                "x": -780,
                "y": 920
              },
              {
                "x": -660,
                "y": 970
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "",
              "description": "Данные платежа (запись чтение)\n",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "3951f447-c48e-4a23-a9dd-381d477dc04c",
                  "title": "[1] Угроза SQL-инъекции",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "+Tampering\nCWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\nВнедрение SQL-инъекции через поля платежного поручения, что может привести к утечке/повреждению хранимых данных.\n",
                  "mitigation": "5.3.5\n[1] Экранирование SQL \n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 20,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              ""
            ],
            "id": "3fb37d12-0081-4425-aa3b-2c40633e4356",
            "source": {
              "x": 13,
              "y": 880
            },
            "target": {
              "cell": "7d330732-e00a-4f00-a09a-264b07404b20",
              "port": "e8de5c9e-c53f-4594-bbec-7765bb16c675"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "f453e49c-0d5b-4735-a5da-cdccb3b9bf11",
                  "title": "[1] Угроза SQL-инъекции",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "+Tampering\nCWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\nВнедрение SQL-инъекции через поля платежного поручения, что может привести к утечке/повреждению хранимых данных.\n",
                  "mitigation": "5.3.5\n[1] Экранирование SQL \n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 21,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              ""
            ],
            "id": "361fb5b2-ae0a-4558-a806-24f14da6341e",
            "source": {
              "x": -435,
              "y": 845
            },
            "target": {
              "cell": "7d330732-e00a-4f00-a09a-264b07404b20",
              "port": "84b21b31-8be0-48eb-9512-ec49470615c9"
            }
          },
          {
            "position": {
              "x": -610.0000000000007,
              "y": 1450
            },
            "size": {
              "width": 200,
              "height": 130
            },
            "attrs": {
              "text": {
                "text": "Logging Service"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 14,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "20ad7dec-6763-4849-af93-9ce8b7a3f86e"
                },
                {
                  "group": "right",
                  "id": "2581dd27-b8ff-4e67-9847-132e8f082a7d"
                },
                {
                  "group": "bottom",
                  "id": "32aa521f-f51f-470d-9b99-7bfe6a79faee"
                },
                {
                  "group": "left",
                  "id": "4bc7dcfc-dcbc-4f05-b6c9-9ea7ad88446a"
                }
              ]
            },
            "id": "4790455c-35ab-402c-82a2-acc71bfe3bbe",
            "data": {
              "type": "tm.Process",
              "name": "Logging Service",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "89f06a11-d4fc-4142-92a2-0993f9187687",
                  "title": "[2] Размещение конфиденциальных данных в логах",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "CWE-532: Insertion of Sensitive Information into Log File\nВозможность утечки конфиденциальных данных о совершаемых юридическим лицом платежах.\n",
                  "mitigation": "7.1.1\n[2] В журнал не должны записываться учетные или платежные данные. Сессионные токены могут записываться в журнал только в необратимой хэшированной форме\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 28,
                  "score": ""
                },
                {
                  "id": "6b364543-168b-4e22-8e16-28a8d729e79b",
                  "title": "[3] Угроза фальсификации событий в журнале",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "CWE-269: Improper Privilege Management\nФальсификация событий в журнале: изменение статуса платежей, сокрытие совершенных действий.\n",
                  "mitigation": "7.3.3 ASVS\n[3] Журналы событий безопасности должы быть защищены от несанкционированного доступа и изменения.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 29,
                  "score": ""
                },
                {
                  "id": "a5f89370-4899-40a9-8039-75a3d3d4acf9",
                  "title": "[3] Недостаточная нейтрализация данных, попадающих в журнал",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "+Information Disclosure\nCWE-117: Improper Output Neutralization for Logs\nЗлоумышленник может изменить статус совершения платежа, кроме того при отправке данных (данные платежа + файл скана поручения) возможно внедрение sql-инъекции, что может привести к XSS при наличии веб-интерфейса у системы логирования.\n\n",
                  "mitigation": "7.3.1 ASVS\n[3] Записи событий в журнал с использованием экранирования для предотвращения инъекции.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 30,
                  "score": ""
                },
                {
                  "id": "757b6d8d-54cf-402f-b10a-b95736ea9b5a",
                  "title": "[3] Не логируются события аутентификации, получения доступа, прохождения контроля поступающих данных",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "CWE-778: Insufficient Logging\nПри отсутствии логирования данных событий невозможно будет доказать попытки подобора brute force -> невозможно отследить атаку, либо доказать причастсность сотрудника к просмотру или модификации платежных данных, например. \n",
                  "mitigation": "7.1.3 ASVS\n[3] Регистрация событий успешной/неуспешной аутентификации, нарушения контроля доступа, десериализации и форматно-логического контроля входных данных.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 31,
                  "score": ""
                },
                {
                  "id": "53dc2b1e-3632-4b08-bb5c-b9e31ace27e0",
                  "title": "[3] Логи содержат избыточную информацию",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "CWE-778: Insufficient Logging\nЕсли злоумышленник совершил платеж от лица компании, но в логи не поступает информация о выполняемых операциях, времени выполнения, идентификаторах пользователей, то при расследовании будет невозомжно доказать вину.\n",
                  "mitigation": "7.1.4 ASVS\n[3] События журнала включают минимально необходимую и достаточную информацию, которая позволит провести его подробное исследование с учетом хронологических связей.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 32,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 1,
                "repudiation": 3,
                "informationDisclosure": 1,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            },
            "tools": {
              "items": [
                "boundary",
                "button-remove",
                "boundary",
                "button-remove"
              ],
              "name": null
            }
          },
          {
            "position": {
              "x": -719,
              "y": 480
            },
            "size": {
              "width": 240,
              "height": 190
            },
            "attrs": {
              "text": {
                "text": "API Gateway"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 15,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "20ad7dec-6763-4849-af93-9ce8b7a3f86e"
                },
                {
                  "group": "right",
                  "id": "2581dd27-b8ff-4e67-9847-132e8f082a7d"
                },
                {
                  "group": "bottom",
                  "id": "32aa521f-f51f-470d-9b99-7bfe6a79faee"
                },
                {
                  "group": "left",
                  "id": "4bc7dcfc-dcbc-4f05-b6c9-9ea7ad88446a"
                }
              ]
            },
            "id": "48746edf-5f59-4c41-8064-2a9175636b03",
            "data": {
              "type": "tm.Process",
              "name": "API Gateway",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": -1110,
              "y": 735
            },
            "size": {
              "width": 140,
              "height": 120
            },
            "attrs": {
              "text": {
                "text": "Auth"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 16,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "20ad7dec-6763-4849-af93-9ce8b7a3f86e"
                },
                {
                  "group": "right",
                  "id": "2581dd27-b8ff-4e67-9847-132e8f082a7d"
                },
                {
                  "group": "bottom",
                  "id": "32aa521f-f51f-470d-9b99-7bfe6a79faee"
                },
                {
                  "group": "left",
                  "id": "4bc7dcfc-dcbc-4f05-b6c9-9ea7ad88446a"
                }
              ]
            },
            "id": "d014f1e7-0413-40f0-8043-3b1852c9d759",
            "data": {
              "type": "tm.Process",
              "name": "Auth",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "e3ca47f4-48aa-4801-a21b-d4f41a0a1aad",
                  "title": "[1] Слабая аутентификация ",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Spoofing",
                  "description": "CWE-287: Improper Authentication\nПри слабой аутентификации злоумышленник может выдать себя за пользователя и отправить платеж от лица компании/ посмотреть информацию о платежах компании\n",
                  "mitigation": "2.7.1 ASVS\n[1] По умолчанию не предлагается передавать второй фактор аутентификации открытым текстом через SMS или ТСОП. Сначала предлагаются более безопасные альтернативы, например, push-уведомления.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                },
                {
                  "id": "fd6054b4-35ab-4b65-bf63-59883864d521",
                  "title": "[1] Возможность перебора",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Spoofing",
                  "description": "CWE-307: Improper Restriction of Excessive Authentication Attempts\nЗлоумышленник может выполнить произвольное кол-во попыток аутентификации с использованием разных паролей и в итоге получить доступ к целевой учетной записи с помощью brute force атаки.\n",
                  "mitigation": "2.2.1 ASVS\n[1] Механизмы защиты от атак методом перебора и блокирования учетных записей. А именно:\n- запрет выбора наиболее распространенных скомпрометированных паролей,\n- временную блокировку учетной записи,\n- ограничение частоты запросов,\n- CAPTCHA,\n- увеличивающиеся интервалы между попытками,\n- ограничение списка допустимых IP-адресов\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": ""
                },
                {
                  "id": "810bf1d7-0f10-44c6-897c-83d2efa25a67",
                  "title": "[2] Не обновляется срок действия запроса аутентификации",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "CWE-287: Improper Authentication\nПри слабой аутентификации злоумышленник может выдать себя за пользователя и отправить платеж от лица компании/ посмотреть информацию о платежах компании\n",
                  "mitigation": "2.7.2 ASVS\n[2] Срок действия запросов аутентификации истекает не\nпозже, чем через 10 минут\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": ""
                },
                {
                  "id": "74f700ad-cd28-4ac7-926a-8e8aada056ff",
                  "title": "[3] Повторное использование кода аутентификации",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "CWE-287: Improper Authentication\nВозможность несколько раз использовать одни и те же коды аутентификации.\n",
                  "mitigation": "2.7.3 ASVS\n[3] Коды аутентификации можно использовать только один раз и только для исходного запроса аутентификации.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 12,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": -504.0000000000002,
              "y": 745
            },
            "size": {
              "width": 140,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "CBS"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 17,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "20ad7dec-6763-4849-af93-9ce8b7a3f86e"
                },
                {
                  "group": "right",
                  "id": "2581dd27-b8ff-4e67-9847-132e8f082a7d"
                },
                {
                  "group": "bottom",
                  "id": "32aa521f-f51f-470d-9b99-7bfe6a79faee"
                },
                {
                  "group": "left",
                  "id": "4bc7dcfc-dcbc-4f05-b6c9-9ea7ad88446a"
                }
              ]
            },
            "id": "53f1cb85-09a7-4c06-8810-f5fad1cb01f4",
            "data": {
              "type": "tm.Process",
              "name": "CBS",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "7e249068-ef57-4eb3-8aac-1e7ff90a57c2",
                  "title": "[2] Отсутствие аутентификации для доступа к критичной системе",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "CWE-306: Missing Authentication for Critical Function\nCBS обеспечивает выполнение транзакций (критическая система), отсутствие надлежащего механизма аутентификации может привести к совершению нелегитимных транзакций.\n",
                  "mitigation": "1.2.2 ASVS\n[2] Взаимодействие между всеми компонентами приложения, включая API, промежуточное ПО и уровень хранения данных, должно быть аутентифицировано. Компоненты должны иметь минимально необходимые\nпривилегии. \nТакже централизованная система аутентификации с мониторингом и журналированием, и разделением на разные уровни аутентификации в зависимости от выполняемых областями функций.\n\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 22,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 18,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Отправка платежей на обработку\nОбратно: статус выполнения",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "3fc82879-8a9b-410f-b06f-55247e8a8a1e",
                  "title": "[1][1] Отсутствие проверки цепочки доверия сертификаторов и подлинности сертификатов",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "CWE-295: Improper Certificate Validation\nФальшивый сертификат ЭДО, клиент примет подделку, если не проверяет цепочку доверия\nБез mTLS внутри сети злоумышленник может перехватить запросы на выполнение платежа, идущие к CBS\n",
                  "mitigation": "1.9.2 ASVS\n[1] Компоненты приложения должны аутентифицировать каждую сторону\nвзаимодействия, чтобы предотвратить mitm атаки.\nНапример, компоненты должны проверять сертификаты и цепочки доверия TLS.\n\n9.2.1 ASVS\n[1] Для подключения к и от сервера используются доверенные сертификаты TLS. Сервер должен быть настроен так, чтобы доверять только утвержденным внутренним центрам сертификации. Все остальные должны отвергаться.\nТакже конфиденциальные данные, закрытые ключи и\nсертификаты должны безопасно храниться в Secure Element, TPM, TEE (Trusted\nExecution Environment) или быть защищены с помощью стойкой криптографии.\n\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 18,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "Отправка платежей на обработку\nОбратно: статус выполнения"
            ],
            "id": "b1e13950-fce3-4cac-8d3d-55b6cdd4bc60",
            "source": {
              "cell": "fbcb8cd5-9bf4-4070-8770-1d779e920134",
              "port": "8dc20c30-944c-47cd-8659-b9650bca409e"
            },
            "target": {
              "cell": "53f1cb85-09a7-4c06-8810-f5fad1cb01f4",
              "port": "2581dd27-b8ff-4e67-9847-132e8f082a7d"
            }
          },
          {
            "position": {
              "x": -524.0000000000002,
              "y": 1191
            },
            "size": {
              "width": 120,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Signature\nValidation"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 19,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "20ad7dec-6763-4849-af93-9ce8b7a3f86e"
                },
                {
                  "group": "right",
                  "id": "2581dd27-b8ff-4e67-9847-132e8f082a7d"
                },
                {
                  "group": "bottom",
                  "id": "32aa521f-f51f-470d-9b99-7bfe6a79faee"
                },
                {
                  "group": "left",
                  "id": "4bc7dcfc-dcbc-4f05-b6c9-9ea7ad88446a"
                }
              ]
            },
            "id": "2c898429-5749-419d-9a01-b076c4eeeb75",
            "data": {
              "type": "tm.Process",
              "name": "Signature\nValidation",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "fa28f44b-d5ea-4940-8b8e-7fb5c64fc2af",
                  "title": "[1] Ошибки в верификации цифровой подписи",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "CWE-347: Improper Verification of Cryptographic Signature\nВ случае отсутствия проверки подписи, использования слабых алгоритмов или отсутствия логов по статусу проверки подписи злоумышленник может подделать подпись, совершить платеж от юридического лица, отрицать свои действия, при этом не будет возможности убедиться в обратном.\n",
                  "mitigation": "NIST 800-63 5.2.5\n[1] Защищенный канал аутентификации\n+\nЦентрализованный механизм логирования (https://top10proactive.owasp.org/the-top-10/c9-security-logging-and-monitoring/)\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 23,
                  "score": ""
                },
                {
                  "id": "de7cfcde-8594-4dbb-b9f3-dbbaa65f500f",
                  "title": "[2] Использование устаревших криптографических алгоритмов",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "+Repudiation\nCWE-327: Use of a Broken or Risky Cryptographic Algorithm\n",
                  "mitigation": "2.9.3 ASVS\n[2] При создании и проверке должны использоваться утвержденные криптографические алгоритмы.\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 24,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 2,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 20,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "0",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "0"
            ],
            "id": "52693079-0af4-454f-9401-a257e7f91ac8",
            "source": {
              "x": -690,
              "y": 590
            },
            "target": {
              "cell": "d014f1e7-0413-40f0-8043-3b1852c9d759",
              "port": "20ad7dec-6763-4849-af93-9ce8b7a3f86e"
            }
          },
          {
            "position": {
              "x": -524.0000000000002,
              "y": 970
            },
            "size": {
              "width": 180,
              "height": 70
            },
            "attrs": {
              "text": {
                "text": "Payment DB"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 21,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "84b21b31-8be0-48eb-9512-ec49470615c9"
                },
                {
                  "group": "right",
                  "id": "e8de5c9e-c53f-4594-bbec-7765bb16c675"
                },
                {
                  "group": "bottom",
                  "id": "4e46bbda-2750-4c69-8912-bc8e3421582f"
                },
                {
                  "group": "left",
                  "id": "7e99e1b6-23d5-4e08-b2f5-1e3809dccb5e"
                }
              ]
            },
            "id": "7d330732-e00a-4f00-a09a-264b07404b20",
            "data": {
              "type": "tm.Store",
              "name": "Payment DB",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "9c6ba625-b200-4efd-ab7f-ba4713807c10",
                  "title": "[1] Хранение данных в незашифрованном виде",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Information disclosure",
                  "description": "CWE-312: Cleartext Storage of Sensitive Information\nЗлоумышленник, получивший доступ к таблицам базы данных с платежами, может читать конфиденциальную информацию, хранящуюся в открытом виде (незашифрованную).\n",
                  "mitigation": "6.1.3 ASVS\n[1] В зашифрованном виде должна храниться регулируемая законом финансовая информация (данные о банковских картах и счетах, о банкротстве, история платежей и т.д.)\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 25,
                  "score": ""
                },
                {
                  "id": "cc439ae8-dca0-44ad-bfff-74d5b96e6725",
                  "title": "[1] Неправильная нейтрализация специальных элементов, используемых в SQL-запросах",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Tampering",
                  "description": "+Information Disclosure\nCWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\nВнедрение SQL-инъекции через поля платежного поручения, что может привести к утечке/повреждению хранимых данных.\n\n",
                  "mitigation": "5.3.4 ASVS\n[1] Запросы к базам данных (SQL, HQL, ORM, NoSQL и пр.) параметризованы посредством ORM, Entity Framework, или иным образом защищены от атак инъекции в базу данных\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 26,
                  "score": ""
                },
                {
                  "id": "a30f6499-fd77-424c-aeb6-2f86ba3ae581",
                  "title": "[3] Угроза отказа в обслуживании",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "CWE-400: Uncontrolled Resource Consumption\nЗлоумышленник может отправить большой объем запросов к БД (например, файл с большим числом форм платежей), что может привести к отказу в обслуживании легальных платежей.\n",
                  "mitigation": "12.1.1 ASVS\n[3] Лимиты запросов к БД (частота, объем запросов)\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 27,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 2,
                "repudiation": 0,
                "informationDisclosure": 4,
                "denialOfService": 2
              }
            }
          }
        ],
        "description": "Internet bank STRIDE diagram"
      }
    ],
    "diagramTop": 1,
    "reviewer": "Maria",
    "threatTop": 32
  }
}